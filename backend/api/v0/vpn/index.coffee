# copyright 2013 J. Maurice <j@wiz.biz>

require './_framework'
require './_framework/http/resource/base'
require './_framework/http/account/session'
require './_framework/http/db/mongo'
require './_framework/util/world'

wiz.package 'cypherpunk.backend.api.v0.vpn'

class cypherpunk.backend.api.v0.vpn.module extends cypherpunk.backend.api.base
	database: null

	init: () =>
		#@database = new cypherpunk.backend.db.vpn(@server, this, @parent.parent.cypherpunkDB)
		# api methods
		@routeAdd new cypherpunk.backend.api.v0.vpn.certificate(@server, this, 'certificate')
		super()

class cypherpunk.backend.api.v0.vpn.certificate extends cypherpunk.backend.api.base
	level: cypherpunk.backend.server.power.level.expired
	handler: (req, res) =>
		#{{{
		p12 = "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"
		#}}}

		out =
			p12: p12

		#console.log out
		res.send 200, out

# vim: foldmethod=marker wrap
